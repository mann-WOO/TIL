# Django Model Relationship

<br>

## 1:N 관계형 DB

> 상하관계(종속적)가 발생한다면 1:N의 관계

### Foreign Key(외래 키)

- 다른 테이블의 행을 식별할 수 있는 키

- 게시글 - 댓글 모델에서, 게시글(1) 쪽에 외래 키 칼럼을 추가하면 '1,  2,  3,  4'(**DB에는 리스트를 기록할 수 없다)**와 같이 댓글의 pk를 기록한다. 댓글(N) 쪽에 외래 키 칼럼을 추가하면 1과 같이 게시글의 pk를 기록한다. 후자가 더 간단하고, 키 값이 유일하기 때문에 N 쪽에 외래 키를 부여한다.

  cf) 데이터 무결성 - 참조 무결성

### on_delete

- `ForeignKey`가 참조하는 객체가 사라졌을 때(참조되는 테이블이 사라졌을 때), `ForeignKey`를 가진 객체(참조하는 객체)를 어떻게 처리할 지 정의한다.
- 데이터 무결성을 유지하기 위한 방법
- `CASCADE`: 부모 객체(참조 된 객체)가 삭제되면 이를 참조하는 객체도 삭제한다.
- 추후 서비스를 개발할 때는 댓글에 작성자 등 데이터가 추가되고 관계가 복잡해지기 때문에, 무조건 `CASCADE`를 사용하면 데이터베이스 구조가 손상될 수 있다. 따라서 다른 선택지도 고려할 수 있어야한다.

### <model 이름>_set

- `<model 이름>_set`: Django가 기본적으로 만들어주는 역참조 manager
- related_name: `model_set`의 이름을 바꿔서 사용할 수 있게 함. M:N 관계에서 쓰임